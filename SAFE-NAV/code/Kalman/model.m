function  [F, G] = model(upd, DCMbn, ab_corr, gb_corr)

Vn =  upd(1);
Ve =  upd(2);
Vd =  upd(3);
lat = upd(4);
h   = upd(5);
fn =  upd(6);
fe =  upd(7);
fd =  upd(8);

Om = 7.292115e-5;
I = eye(3);
Z = zeros(3);
    
[R_N,R_E] = earth (lat);    
RO = sqrt(R_E*R_N);

A = diag(-1./ab_corr);
G = diag(-1./gb_corr);

F11 = 0;
F12 = -( (Om * sin(lat)) + (Ve / RO * tan(lat)) );
F13 = Vn / RO;
F21 = (Om * sin(lat)) + (Ve / RO * tan(lat));
F22 = 0 ;
F23 = (Om * cos(lat)) + (Ve / RO) ;
F31 = -Vn / RO;
F32 = -Om * cos(lat) - (Ve / RO);
F33 = 0;

F14 = 0;
F15 = 1 / RO;
F16 = 0;
F24 = -1 / RO;
F25 = 0;
F26 = 0;
F34 = 0;
F35 = -tan(lat) / RO;
F36 = 0;

F17 = -Om * sin(lat);
F18 = 0;
F19 = -Ve / (RO^2);
F27 = 0 ;
F28 = 0 ;
F29 = Vn / (RO^2);
F37 =  -Om * cos(lat) - (Ve / ((RO) * (cos(lat))^2));
F38 = 0 ;
F39 = (Ve * tan(lat)) / (RO^2) ;

F41 = 0 ;
F42 = -fd ;
F43 = fe ;
F51 = fd ;
F52 = 0 ;
F53 = -fn ;
F61 = -fe ;
F62 = fn ;
F63 = 0 ;

F44 = Vd / RO;
F45 = -2 * ((Om * sin(lat)) + ((Ve / RO) * tan(lat))) ;
F46 = Vn / RO ;
F54 = (2 * Om * sin(lat)) + ( (Ve / RO) * tan(lat) );
F55 = (1 / RO) * ((Vn * tan(lat)) + Vd) ;
F56 = 2 * Om * cos(lat) + (Ve / RO);
F64 = (-2 * Vn) / RO;
F65 = -2 * (Om * cos(lat) +  (Ve / RO)) ;
F66 = 0;

F47 = -Ve * ((2 * Om * cos(lat)) + (Ve / (RO * (cos(lat))^2)));
F48 = 0 ;
F49 = (1 / RO^2) * ( (Ve^2 * tan(lat)) - (Vn * Vd) );
F57 = 2 * Om * ( (Vn * cos(lat)) - (Vd * sin(lat)) ) + ( (Vn * Ve) / (RO * (cos(lat))^2) ) ;
F58 = 0 ;
F59 = -(Ve / RO^2) * (Vn * tan(lat) + Vd);
F67 = 2 * Om * Ve * sin(lat);
F68 = 0;
F69 = (1 / RO^2) * (Vn^2 + Ve^2);

F71 = 0;
F72 = 0;
F73 = 0;
F81 = 0;
F82 = 0;
F83 = 0;
F91 = 0;
F92 = 0;
F93 = 0;

F74 = 1 / RO;
F75 = 0;
F76 = 0;
F84 = 0;
F85 = 1 / (RO * cos(lat));
F86 = 0;
F94 = 0;
F95 = 0;
F96 = -1;

F77 = 0;
F78 = 0;
F79 = -Vn / RO^2;
F87 = (Ve * tan(lat)) / (RO * cos(lat));
F88 = 0;
F89 = -Ve / (RO^2 * cos(lat));
F97 = 0;
F98 = 0;
F99 = 0;

F10_1 = 0;
F10_2 = 0;
F10_3 = 0;
F11_1 = 0;
F11_2 = 0;
F11_3 = 0;
F12_1 = 0;
F12_2 = 0;
F12_3 = 0;

F13_1 = 0;
F13_2 = 0;
F13_3 = 0;
F14_1 = 0;
F14_2 = 0;
F14_3 = 0;
F15_1 = 0;
F15_2 = 0;
F15_3 = 0;

F10_4 = 0;
F10_5 = 0;
F10_6 = 0;
F11_4 = 0;
F11_5 = 0;
F11_6 = 0;
F12_4 = 0;
F12_5 = 0;
F12_6 = 0;

F13_4 = 0;
F13_5 = 0;
F13_6 = 0;
F14_4 = 0;
F14_5 = 0;
F14_6 = 0;
F15_4 = 0;
F15_5 = 0;
F15_6 = 0;

F10_7 = 0;
F10_8 = 0;
F10_9 = 0;
F11_7 = 0;
F11_8 = 0;
F11_9 = 0;
F12_7 = 0;
F12_8 = 0;
F12_9 = 0;

F13_7 = 0;
F13_8 = 0;
F13_9 = 0;
F14_7 = 0;
F14_8 = 0;
F14_9 = 0;
F15_7 = 0;
F15_8 = 0;
F15_9 = 0;

F1_10 = DCMbn(1,1);
F1_11 = DCMbn(1,2);
F1_12 = DCMbn(1,3);
F2_10 = DCMbn(2,1);
F2_11 = DCMbn(2,2);
F2_12 = DCMbn(2,3);
F3_10 = DCMbn(3,1);
F3_11 = DCMbn(3,2);
F3_12 = DCMbn(3,3);

F4_10 = 0;
F4_11 = 0;
F4_12 = 0;
F5_10 = 0;
F5_11 = 0;
F5_12 = 0;
F6_10 = 0;
F6_11 = 0;
F6_12 = 0;

F7_10 = 0;
F7_11 = 0;
F7_12 = 0;
F8_10 = 0;
F8_11 = 0;
F8_12 = 0;
F9_10 = 0;
F9_11 = 0;
F9_12 = 0;

F10_10 = G(1,1); 
F10_11 = G(1,2);
F10_12 = G(1,3);
F11_10 = G(2,1);
F11_11 = G(2,2);
F11_12 = G(2,3);
F12_10 = G(3,1);
F12_11 = G(3,2);
F12_12 = G(3,3);

F13_10 = 0; 
F13_11 = 0;
F13_12 = 0;
F14_10 = 0;
F14_11 = 0;
F14_12 = 0;
F15_10 = 0;
F15_11 = 0;
F15_12 = 0;

F1_13 = 0; 
F1_14 = 0;
F1_15 = 0;
F2_13 = 0;
F2_14 = 0;
F2_15 = 0;
F3_13 = 0;
F3_14 = 0;
F3_15 = 0;

F4_13 = -DCMbn(1,1); 
F4_14 = -DCMbn(1,2);
F4_15 = -DCMbn(1,3);
F5_13 = -DCMbn(2,1);
F5_14 = -DCMbn(2,2);
F5_15 = -DCMbn(2,3);
F6_13 = -DCMbn(3,1);
F6_14 = -DCMbn(3,2);
F6_15 = -DCMbn(3,3);

F7_13 = 0; 
F7_14 = 0;
F7_15 = 0;
F8_13 = 0;
F8_14 = 0;
F8_15 = 0;
F9_13 = 0;
F9_14 = 0;
F9_15 = 0;

F10_13 = 0; 
F10_14 = 0;
F10_15 = 0;
F11_13 = 0;
F11_14 = 0;
F11_15 = 0;
F12_13 = 0;
F12_14 = 0;
F12_15 = 0;

F13_13 = A(1,1); 
F13_14 = A(1,2);
F13_15 = A(1,3);
F14_13 = A(2,1);
F14_14 = A(2,2);
F14_15 = A(2,3);
F15_13 = A(3,1);
F15_14 = A(3,2);
F15_15 = A(3,3);


F=[F11,F12,F13,F14,F15,F16,F17,F18,F19,F1_10,F1_11,F1_12,F1_13,F1_14,F1_15; ...
   F21,F22,F23,F24,F25,F26,F27,F28,F29,F2_10,F2_11,F2_12,F2_13,F2_14,F2_15; ...
   F31,F32,F33,F34,F35,F36,F37,F38,F39,F3_10,F3_11,F3_12,F3_13,F3_14,F3_15; ...
   F41,F42,F43,F44,F45,F46,F47,F48,F49,F4_10,F4_11,F4_12,F4_13,F4_14,F4_15; ...
   F51,F52,F53,F54,F55,F56,F57,F58,F59,F5_10,F5_11,F5_12,F5_13,F5_14,F5_15; ...
   F61,F62,F63,F64,F65,F66,F67,F68,F69,F6_10,F6_11,F6_12,F6_13,F6_14,F6_15; ...
   F71,F72,F73,F74,F75,F76,F77,F78,F79,F7_10,F7_11,F7_12,F7_13,F7_14,F7_15; ...
   F81,F82,F83,F84,F85,F86,F87,F88,F89,F8_10,F8_11,F8_12,F8_13,F8_14,F8_15; ...
   F91,F92,F93,F94,F95,F96,F97,F98,F99,F9_10,F9_11,F9_12,F9_13,F9_14,F9_15; ...
   F10_1,F10_2,F10_3,F10_4,F10_5,F10_6,F10_7,F10_8,F10_9,F10_10,F10_11,F10_12,F10_13,F10_14,F10_15; ...
   F11_1,F11_2,F11_3,F11_4,F11_5,F11_6,F11_7,F11_8,F11_9,F11_10,F11_11,F11_12,F11_13,F11_14,F11_15; ...
   F12_1,F12_2,F12_3,F12_4,F12_5,F12_6,F12_7,F12_8,F12_9,F12_10,F12_11,F12_12,F12_13,F12_14,F12_15; ...
   F13_1,F13_2,F13_3,F13_4,F13_5,F13_6,F13_7,F13_8,F13_9,F13_10,F13_11,F13_12,F13_13,F13_14,F13_15; ...
   F14_1,F14_2,F14_3,F14_4,F14_5,F14_6,F14_7,F14_8,F14_9,F14_10,F14_11,F14_12,F14_13,F14_14,F14_15; ...    
   F15_1,F15_2,F15_3,F15_4,F15_5,F15_6,F15_7,F15_8,F15_9,F15_10,F15_11,F15_12,F15_13,F15_14,F15_15];
   
   
   
G = [DCMbn  Z     Z    Z;
    Z      -DCMbn 	Z    Z;
    Z      Z     	Z    Z;
    Z      Z     	I    Z;
    Z      Z     	Z    I;];
end
